<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Protocol++(Protocolpp): jxmss Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Protocol++(Protocolpp)
   &#160;<span id="projectnumber">v5.4.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classjxmss.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">jxmss Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &quot;include/jxmss.h&quot;</code></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The eXtended Merkel Signature Scheme (XMSS), a hash-bashed digital signature scheme that is based on existing descriptions in scientific literature. There are three types of signatures specified for Winternitz One-Time Signature Plus (WOTS+), a one-time signature scheme; XMSS, a single-tree scheme; and XMSS^MT, a multi-tree variant of XMSS. Both XMSS and XMSS^MT use WOTS+ as a main bulding block. XMSS provides cryptographic digital signatures without relying on the conjectured hardness of mathematical problems. Instead, it is proven that it only relies on the properties of cryptographic hash functions. XMSS provides strong security guarantees and is even secure when the collison resistance of the underlying hash function is broken. Its is suitable for compact implementations, is relatively simple to implement, and naturally resists side-channel attacks. Unlike most other signature systems, hash-based signatures can so far withstand known attacks using quantum computers</p>
<p>XMSS uses four cryptographic components: WOTS+ as OTS method, two additional cryptographic hash functions H and H_msg, and a pseudorandom function PRF. One of the main advantages of XMSS with WOTS+ is that is does not rely on the collision resistance of the used hash functions but on weaker properties. Each XMSS public/private key pair is associated with a perfect binary tree, every node of which contains an n-byte value</p>
<p>XMSS has the following parameters:</p>
<ul>
<li>h - the height (number of levels - 1) of the tree</li>
<li>n - the length in bytes of the message digest as well as each node</li>
<li>w - the Winternitz parameter as defined for WOTS+ (16)</li>
</ul>
<p>There are 2^h leaves in the tree</p>
<p><b>XMSS Hash Functions</b></p>
<p>XMSS uses two additional cryptographic functions besides hash function F and pseudorandom function PRF required by WOTS+ which are</p>
<ul>
<li>A cryptographic function H. H accepts n-byte keys and byte strings of length 2n and returns an n-byte string</li>
<li>A cryptographic hash functions H_msg. H_msg accepts 3n-byte keys and byte strings of arbitrary length and returns an n-byte string</li>
</ul>
<p><b>XMSS Private Key</b></p>
<p>An XMSS private key SK contains 2^h WOTS+ private keys, the leaf index idx of the next WOTS+ private key that has not yet been used, SK_PRF (an n-byte key to generate pseudorandom values for randomized message hashing), the n-byte value root (which is the root node of the tree and SEED), and the n-byte public seed used to pseudorandomly generate bitmasks and hash function keys. The root and SEED are required for functions that do not take the public key as input</p>
<p><b>XMSS Key Generation</b></p>
<p>The XMSS public key PK consists of the root of the binary hash tree and the seed SEED, both also stored in SK. The root is computed using treeHash. For XMSS, there is only a single main tree. Hence, the used address is set to the all-zero string in the beginning. Note that we do not define any specific format or handling for the XMSS private key SK by introducing this algorithm</p>
<p>It is strongly RECOMMENDED to use pseudorandom key generation to reduce the private key size</p>
<p>The format of an XMSS public key is given below </p><div class="fragment"><div class="line">+---------------------------+</div>
<div class="line">|      algorithm OID        |</div>
<div class="line">+---------------------------+</div>
<div class="line">|         root node         | n bytes</div>
<div class="line">+---------------------------+</div>
<div class="line">|          <a class="code" href="namespaceProtocolPP.html#a44018cab1f12fe3ca4e2f32c547eab36a76a2ea9d5bce744be549425b2dadd0e7">SEED</a>             | n bytes</div>
<div class="line">+---------------------------+</div>
<div class="ttc" id="anamespaceProtocolPP_html_a44018cab1f12fe3ca4e2f32c547eab36a76a2ea9d5bce744be549425b2dadd0e7"><div class="ttname"><a href="namespaceProtocolPP.html#a44018cab1f12fe3ca4e2f32c547eab36a76a2ea9d5bce744be549425b2dadd0e7">ProtocolPP::SEED</a></div><div class="ttdeci">@ SEED</div><div class="ttdoc">Testbench seed.</div><div class="ttdef"><b>Definition:</b> jenum.h:762</div></div>
</div><!-- fragment --><p>The authentication path is an array of h n-byte strings. It contains the siblings of the nodes on the path from the used leaf to the root. It does not contain the nodes on the path itself. A verifier needs these nodes to compute a root node for the tree from the WOTS+ public key. A node Node is addressed by its position in the tree. Node(x,y) denotes the y^th node on level x with y=0 being the leftmost node on a level. The leaves are on level 0; the root is on level h. An authentication path contains exactly one node on every layer 0 &lt;= x &lt;= (h-1). For the i^th WOTS+ key pair, counting from zero, the j^th authentication path node is</p>
<p><img class="formulaInl" alt="$ Node(j, std::floor(i/{2}^{j}) XOR 1) $" src="form_470.png"/></p>
<p><b>XMSS Signature Generation</b></p>
<p>To compute the XMSS signature of a message M with an XMSS private key, the signer first computes a randomized message digest using a random value r, idx_sig, the index of the WOTS+ key pair to be used, and the root value from the public key as key. Then, a WOTS+ signature of the message digest is computed using the next unused WOTS+ private key. Next, the authentication path is computed. Finally, the private key is updated, i.e., idx is incremented. An implementation MUST NOT output the signature before the private key is updated. The data format for a signature is given below</p>
<div class="fragment"><div class="line">+----------------------------+</div>
<div class="line">|       index idx_sig        | 4 bytes</div>
<div class="line">+----------------------------+</div>
<div class="line">|                            |</div>
<div class="line">|        randomness r        | n bytes</div>
<div class="line">|                            |</div>
<div class="line">+----------------------------+</div>
<div class="line">|                            |</div>
<div class="line">|   WOTS+ signature sig_ots  | len * n bytes</div>
<div class="line">|                            |</div>
<div class="line">+----------------------------+</div>
<div class="line">|         auth[0]            | n bytes</div>
<div class="line">+----------------------------+</div>
<div class="line">|           ...              |</div>
<div class="line">+----------------------------+</div>
<div class="line">|        auth[h-1]           | n bytes</div>
<div class="line">+----------------------------+</div>
<div class="line">        <a class="code" href="namespaceProtocolPP.html#a15957f30f5cdc906a54e53fcb4834e5ca6f8b3788be7b5f3a0156d6b135dde350">XMSS</a> Signature</div>
<div class="ttc" id="anamespaceProtocolPP_html_a15957f30f5cdc906a54e53fcb4834e5ca6f8b3788be7b5f3a0156d6b135dde350"><div class="ttname"><a href="namespaceProtocolPP.html#a15957f30f5cdc906a54e53fcb4834e5ca6f8b3788be7b5f3a0156d6b135dde350">ProtocolPP::XMSS</a></div><div class="ttdeci">@ XMSS</div><div class="ttdoc">XMSS Signature method.</div><div class="ttdef"><b>Definition:</b> jenum.h:1267</div></div>
</div><!-- fragment --><p><b>XMSS Signature Verification</b></p>
<p>An XMSS signature is verified by first computing the message digest using randomness r, index idx_sig, the root from PK and message M. The used WOTS+ public key pk_ots is computed from the WOTS+ signature using WOTS_pkFromSig. The WOTS+ public key in turn is used to compute the corresponding leaf using an L-tree. The leaf, together with idex idx_sig and authentication root value for the tree. The verification succeeds if and only if the computed root value matches the one in the XMSS public key. In any other case, it MUST return fail</p>
<p>The main part of the XMSS signature verification is done by the function XMSS_rootFromSig described below. XMSS_rootFromSig takes as input an index idx_sig, a WOTS+ signature sig_ots an authentication path auth, an n-byte message M', seed SEED, and address ADRS. XMSS_rootFromSig returns an n-byte string holding the value of the root of a tree defiend by the input data</p>
<div class="image">
<img src="quantumresist.jpg" alt=""/>
<div class="caption">
QuantumResist</div></div>
 <p><b>XMSS^MT: Multi-Tree XMSS</b></p>
<p>XMSS^MT builds on XMSS by using a tree of several layers of XMSS trees, a so-called hypertree. The trees on top and intermediate layers are used to sign the root nodes of the trees on the respective layer below. Trees on the lowest layer are used to sign the acutal messages. All XMSS trees in XMSS^MT have equal height</p>
<p><b>XMSS^MT Parameters</b></p>
<p>In addition to XMSS parameters, an XMSS^MT system requires the number of tree layers d, specified as an integer value that divides h without remainder. The same tree height h/d and the same Winternitz parameter w are used for all tree layers</p>
<p><b>XMSS^MT Signature</b></p>
<p>An XMSS^MT signature Sig_MT is a byte string of length (std::ceil(h / 8) + n (h + d * len) * n) It consists of:</p>
<ul>
<li>the index idx_sig of the used WOTS+ key pair on the bottom layer std::ceil(h / 8) bytes</li>
<li>a byte string r used for randomized message hashing (n bytes)</li>
<li>d reduced XMSS signatures ((h / d + len) * n bytes each)</li>
</ul>
<p>The reduced XMSS signatures only contain a WOTS+ signature sig_ots and an authentication path auth. They contain no index idx and no byte string r. The XMSS^MT signature has the following format</p>
<div class="fragment"><div class="line">+----------------------------------+</div>
<div class="line">|           index idx_sig          | std::ceil(h / 8) bytes</div>
<div class="line">+----------------------------------+</div>
<div class="line">|                                  |</div>
<div class="line">|           randomness r           | n bytes</div>
<div class="line">|                                  |</div>
<div class="line">+----------------------------------+</div>
<div class="line">|                                  |</div>
<div class="line">| (reduced) XMSS signature sig_ots | (h / d + len) * n bytes</div>
<div class="line">|                                  |</div>
<div class="line">+----------------------------------+</div>
<div class="line">|                                  |</div>
<div class="line">| (reduced) XMSS signature sig_ots | (h / d + len) * n bytes</div>
<div class="line">|                                  |</div>
<div class="line">+----------------------------------+</div>
<div class="line">|               ...                |</div>
<div class="line">+----------------------------------+</div>
<div class="line">|                                  |</div>
<div class="line">| (reduced) XMSS signature sig_ots | (h / d + len) * n bytes</div>
<div class="line">|                                  |</div>
<div class="line">+----------------------------------+</div>
<div class="line">          XMSS^MT Signature</div>
</div><!-- fragment --> <div class="image">
<img src="xmss_tree.png" alt=""/>
<div class="caption">
XMSS Tree</div></div>
 <center>Protocol++&reg; (<a class="el" href="namespaceProtocolPP.html">ProtocolPP</a>&reg;) written by : John Peter Greninger &bull; &copy; John Peter Greninger 2015-2023 &bull; All Rights Reserved</center> <center><sub>All copyrights and trademarks are the property of their respective owners</sub></center><p>The source code contained or described herein and all documents related to the source code (herein called "Material") are owned by John Peter Greninger and Sheila Rocha Greninger. Title to the Material remains with John Peter Greninger and Sheila Rocha Greninger. The Material contains trade secrets and proprietary and confidential information of John Peter Greninger and Sheila Rocha Greninger. The Material is protected by worldwide copyright and trade secret laws and treaty provisions. No part of the Material may be used, copied, reproduced, modified, published, uploaded, posted, transmitted, distributed, or disclosed in any way without prior express written consent of John Peter Greninger and Sheila Rocha Greninger (both are required)</p>
<p>No license under any patent, copyright, trade secret, or other intellectual property right is granted to or conferred upon you by disclosure or delivery of the Materials, either expressly, by implication, inducement, estoppel, or otherwise. Any license under such intellectual property rights must be express and approved by John Peter Greninger and Sheila Rocha Greninger in writing</p>
<p>Licensing information can be found at <b>www.protocolpp.com/license</b> with use of the binary forms permitted provided that the following conditions are met:</p>
<ul>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution</li>
<li>Any and all modifications must be returned to John Peter Greninger at GitHub.com <a href="https://github.com/jpgreninger/protocolpp">https://github.com/jpgreninger/protocolpp</a> for evaluation. Inclusion of modifications in the source code shall be determined solely by John Peter Greninger. Failure to provide modifications shall render this license NULL and VOID and revoke any rights to use of Protocol++&reg;</li>
<li>Commercial use (incidental or not) requires a fee-based license obtainable at <b>www.protocolpp.com/shop</b></li>
<li>Academic or research use requires prior written and notarized permission from John Peter and Sheila Rocha Greninger</li>
</ul>
<p>Use of the source code requires purchase of the source code. Source code can be purchased at <b>www.protocolpp.com/shop</b></p>
<ul>
<li><b>US Copyrights at <a href="https://www.copyright.gov/">https://www.copyright.gov/</a></b><ul>
<li><b>TXu002059872 (Version 1.0.0)</b></li>
<li><b>TXu002066632 (Version 1.2.7)</b></li>
<li><b>TXu002082674 (Version 1.4.0)</b></li>
<li><b>TXu002097880 (Version 2.0.0)</b></li>
<li><b>TXu002169236 (Version 3.0.1)</b></li>
<li><b>TXu002182417 (Version 4.0.0)</b></li>
<li><b>TXu002219402 (Version 5.0.0)</b></li>
<li><b>TXu002272076 (Version 5.2.1)</b></li>
</ul>
</li>
</ul>
<p>The name of its contributor may not be used to endorse or promote products derived from this software without specific prior written permission and licensing</p>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDER AND CONTRIBUTOR "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE </p>
</div><hr/>The documentation for this class was generated from the following file:<ul>
<li>jxmss/include/jxmss.h</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classjxmss.html">jxmss</a></li>
    <li class="footer">Generated on Mon Jan 2 2023 20:51:30 for Protocol++(Protocolpp) by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
